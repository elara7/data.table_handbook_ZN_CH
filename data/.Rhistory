library(data.table)
setwd("C:/Users/elara/Downloads/github/data.table_handbook_ZN_CH/data")
DT = fread('melt_default.csv')
setwd("C:/Users/elara/Downloads/github/data.table_handbook_ZN_CH/data")
DT = fread('melt_default.csv')
DT
DT.m1 <- melt(DT, id.vars = c('family_id', 'age_mother'),
measure.vars = c('dob_child1', 'dob_child2', 'dob_child3'))
DT.m1
dcast(DT.m1, family_id + age_mother ~ child, value.var = 'dob')
DT.m1 <- melt(DT, measure.vars = c('dob_child1', 'dob_child2', 'dob_child3'),
variable.name = 'child', value.name = 'dob')
DT.m1
dcast(DT.m1, family_id + age_mother ~ child, value.var = 'dob')
dcast(DT.m1, family_id ~ . ,fun.agg = function(x) sum(!is.na(x)), value.var = 'dob')
DT <- fread('melt_enhanced.csv')
setwd("C:/Users/elara/Downloads/github/data.table_handbook_ZN_CH/data")
DT <- fread('melt_enhanced.csv')
setwd("C:/Users/elara/Downloads/github/data.table_handbook_ZN_CH/data")
knitr::opts_chunk$set(echo = TRUE)
setwd("C:/Users/elara/Downloads/github/data.table_handbook_ZN_CH/data")
root.dir = "C:/Users/elara/Downloads/github/data.table_handbook_ZN_CH/data"
DT = fread('melt_default.csv')
root.dir = "C:/Users/elara/Downloads/github/data.table_handbook_ZN_CH/data"
DT = fread('melt_default.csv')
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(root.dir = normalizePath("C:/Users/elara/Downloads/github/data.table_handbook_ZN_CH/data"))
DT = fread('melt_default.csv')
setwd("C:/Users/elara/Downloads/github/data.table_handbook_ZN_CH/data")
knitr::opts_chunk$set(echo = TRUE)
DT = fread('melt_default.csv')
DT = fread('melt_default.csv')
DT = fread('melt_default.csv')
DT
str(DT)
DT.m1 <- melt(DT, id.vars = c('family_id', 'age_mother'),
measure.vars = c('dob_child1', 'dob_child2', 'dob_child3'))
DT.m1
str(DT.m1)
DT.m1 <- melt(DT, measure.vars = c('dob_child1', 'dob_child2', 'dob_child3'),
variable.name = 'child', value.name = 'dob')
DT.m1
dcast(DT.m1, family_id + age_mother ~ child, value.var = 'dob')
dcast(DT.m1, family_id ~ . ,fun.agg = function(x) sum(!is.na(x)), value.var = 'dob')
DT <- fread('melt_enhanced.csv')
DT
DT.m1 = melt(DT, id = c("family_id", "age_mother"))
DT.m1[, c("variable", "child") := tstrsplit(variable, "_", fixed = TRUE)]
DT.c1 = dcast(DT.m1, family_id + age_mother + child ~ variable, value.var = "value")
DT.c1
DT.m1 = melt(DT, id = c("family_id", "age_mother"))
DT.m1[, c("variable", "child") := tstrsplit(variable, "_", fixed = TRUE)]
DT.c1 = dcast(DT.m1, family_id + age_mother + child ~ variable, value.var = "value")
DT.c1 = dcast(DT.m1, family_id + age_mother + child ~ variable, value.var = "value")
DT.c1
str(DT.c1)
colA <-  paste('dob_child', 1:3, sep = "")
colB <-  paste('gender_child', 1:3, sep = "")
DT.m2 <- melt(DT, measure = list(colA, colB), value.name = c('dob', 'gender'))
DT.m2
str(DT.m2)
DT.m2 <- melt(DT, measure = patterns('^dob','^gender'), value.name = c('dob', 'gender'))
DT.m2
DT.c2 <- dcast(DT.m2, family_id + age_mother ~ variable, value.var = c('dob','gender'))
DT.c2
